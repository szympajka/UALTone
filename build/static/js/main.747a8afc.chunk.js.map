{"version":3,"sources":["sources/octaves.js","core/api/share.js","components/notes/notes.js","config/config.js","components/qr/qr.js","components/userend/userend.js","index.js"],"names":["octaves","window","location","hash","replace","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","Octaves","styled","div","_templateObject","innerWidth","Title","h1","_templateObject2","OctaveKey","_templateObject3","random","size","props","play","Btn","_templateObject4","colorArray","synth","Tone","Synth","toMaster","playSequence","state","setState","Transport","stop","notes","getToneTime","note","arguments","length","undefined","notetime","now","forEach","n","push","console","log","data","m","o","d","octave","description","schedule","time","triggerAttackRelease","Draw","document","getElementById","innerHTML","style","color","indexOf","toArray","backgroundColor","Time","toSeconds","Object","objectSpread","ongoing","scan","start","Notes","_useState","useState","albumID","_useState2","slicedToArray","fetchNotes","_ref2","asyncToGenerator","regenerator_default","a","mark","_callee2","wrap","_context2","prev","next","code","fetch","concat","sent","json","flattenDeep","this","apply","react_default","createElement","Fragment","type","onClick","id","map","i","key","config","BrowserQRCodeReader","_ref","_callee","_context","UserEnd","GlobalStyle","createGlobalStyle","src_templateObject","App","children","slice","ReactDOM","render","src_App","notes_notes","userend"],"mappings":"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","file":"static/js/main.747a8afc.chunk.js","sourcesContent":["export default {\n  0: 'C1',\n  1: 'D1',\n  2: 'E1',\n  3: 'F1',\n  4: 'G1',\n  5: 'A1',\n  6: 'B1',\n  7: 'C2',\n  8: 'D2',\n  9: 'E2',\n  10: 'F2',\n  11: 'G2',\n  12: 'A2',\n  13: 'B2',\n  14: 'C3',\n  15: 'D3',\n  16: 'E3',\n  17: 'F3',\n  18: 'G3',\n  19: 'A3',\n  20: 'B3',\n  21: 'C4',\n  22: 'D4',\n  23: 'E4',\n  24: 'F4',\n  25: 'G4',\n  26: 'A4',\n  27: 'B4',\n  28: 'C5',\n  29: 'D5',\n  30: 'E5',\n  31: 'F5',\n  32: 'G5',\n  33: 'A5',\n  34: 'B5',\n  35: 'C6',\n  36: 'D6',\n  37: 'E6',\n  38: 'F6',\n  39: 'G6',\n  40: 'A6',\n  41: 'B6',\n  42: 'C7',\n  43: 'D7',\n  44: 'E7',\n  45: 'F7',\n  46: 'G7',\n  47: 'A7',\n  48: 'B7',\n};\n","const serverURL = 'https://devapi.imglish.com';\nconst token = window.location.hash.replace('#', '');\n\nconst defaultParams = {\n  id: 0,\n};\n\nconst getAlbum = (pms = defaultParams) => fetch(`${serverURL}/album/${pms.id}`, {\n  method: 'GET',\n  headers: new Headers({\n    'Content-Type': 'application/json',\n    Authorization: `Bearer ${token}`,\n  }),\n});\n\nexport default {\n  getAlbum,\n};\n","// ####### Declarations ##########\nimport React, { useState } from 'react';\nimport Tone from 'tone';\nimport styled from 'styled-components';\nimport {\n  flattenDeep, map, forEach, size, random, findIndex, indexOf, toArray,\n} from 'lodash';\nimport ShareApi from '../../core/api/share';\nimport octaves from '../../sources/octaves';\n\n// ####### Styled Components #############\nconst Octaves = styled.div`\n  position: relative;\n  width: ${(window.innerWidth / 3)}px;\n  height: ${(window.innerWidth / 3)}px;\n  background: #000;\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n`;\nconst Title = styled.h1`\n  font-size: 5em;\n  margin: 0;\n  background-color: rgba(0, 0, 0, 0.7);\n  z-index: 10;\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\nconst OctaveKey = styled.div`\n  // border-top-left-radius: ${() => random(0, size(octaves))}px;\n  // border-top-right-radius: ${() => random(0, size(octaves))}px;\n  // border-bottom-left-radius: ${() => random(0, size(octaves))}px;\n  // border-bottom-right-radius: ${() => random(0, size(octaves))}px;\n  width: ${(window.innerWidth / 3) / (size(octaves) / 7)}px;\n  height: ${(window.innerWidth / 3) / (size(octaves) / 7)}px;\n  // color: transparent;\n  color: #000;\n  font-size: 16px;\n  display: flex;\n  background-color: #000;\n  // background-color: ${props => (props.play ? '#ff0007ab' : 'transparent')};\n  justify-content: center;\n  align-items: center;\n  transition: all ease-in 0.2s;\n\n  // :nth-of-type(2n){\n  //   background-color: #967171\n  // }\n`;\nconst Btn = styled.div`\n  background: transparent;\n  opacity: 0;\n  padding: 12px 18px;\n  border-radius: 5px;\n  color: rgb(255, 255, 255);\n  font-weight: 400;\n  position: fixed;\n  z-index: 100;\n  bottom: 20px;\n  left: 50%;\n  transform: translatex(-50%);\n  margin: auto;\n  display: inline-block;\n  border: solid 1px;\n`;\n\n// ####### Helpers ##########\nconst colorArray = [\n  '#FF6633', '#FFB399', '#FF33FF', '#FFFF99', '#00B3E6',\n  '#E6B333', '#3366E6', '#999966', '#99FF99', '#B34D4D',\n  '#80B300', '#809900', '#E6B3B3', '#6680B3', '#66991A',\n  '#FF99E6', '#CCFF1A', '#FF1A66', '#E6331A', '#33FFCC',\n  '#66994D', '#B366CC', '#4D8000', '#B33300', '#CC80CC',\n  '#66664D', '#991AFF', '#E666FF', '#4DB3FF', '#1AB399',\n  '#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680',\n  '#4D8066', '#809980', '#E6FF80', '#1AFF33', '#999933',\n  '#FF3380', '#CCCC00', '#66E64D', '#4D80CC', '#9900B3',\n  '#E64D66', '#4DB380', '#FF4D4D', '#99E6E6', '#6666FF',\n];\n\nconst asyncForEach = async (array, callback) => {\n  for (let index = 0; index < array.length; index += 1) {\n    await callback(array[index], index, array); // eslint-disable-line\n  }\n};\n\n// ####### Functions ##########\nconst synth = new Tone.Synth().toMaster();\n\nconst playSequence = (state, setState) => {\n  Tone.Transport.stop();\n\n  const notes = [];\n\n  const getToneTime = (note = '4n') => {\n    let notetime = Tone.now();\n\n    notes.forEach((n) => {\n      notetime += n;\n    });\n\n    notes.push(note);\n\n    console.log('notetime', notetime);\n\n    return notetime;\n  };\n\n  const play = (o, n, d) => {\n    Tone.Transport.schedule((time) => {\n      synth.triggerAttackRelease(o, n, time);\n      Tone.Draw.schedule(() => {\n        document.getElementById('text').innerHTML = d;\n        document.getElementById('text').style.color = colorArray[indexOf(toArray(octaves), o)];\n        document.getElementById(o).style.backgroundColor = colorArray[indexOf(toArray(octaves), o)];\n      }, time);\n\n      Tone.Draw.schedule(() => {\n        document.getElementById(o).style.backgroundColor = '';\n      }, time + Tone.Time(n).toSeconds());\n    }, getToneTime(n));\n  };\n\n  state.data.forEach((m) => {\n    const { octave, note, description } = m;\n    play(octave, note, description);\n  });\n\n  Tone.Transport.schedule(() => {\n    document.getElementById('text').innerHTML = '';\n    setState({ ...state, data: [], ongoing: false });\n    window.scan();\n  }, getToneTime());\n\n  Tone.Transport.start();\n};\n\n// ####### Composing view ##########\nconst Notes = () => {\n  console.log('render');\n  const [state, setState] = useState({\n    ongoing: false,\n    data: [],\n    albumID: 0,\n    play: '',\n  });\n\n  const getNotes = () => {\n    setState({\n      ...state,\n      ongoing: true,\n    });\n  };\n\n  const updateInput = (e) => {\n    setState({\n      ...state,\n      albumID: e.target.value,\n    });\n  };\n\n  const fetchNotes = async () => {\n    if (!window.code) {\n      window.code = 422;\n    }\n\n    const data = [];\n    // const album = await (await ShareApi.getAlbum({ id: window.code })).json();\n\n    // await asyncForEach(album.message.photos, async (photo) => {\n    // const notes = await (await fetch(`http://127.0.0.1:9999?photoID=${photo.id}&imageURI=${encodeURIComponent(photo.file.path)}`)).json();\n    const notes = await (await fetch(`http://127.0.0.1:9999?photoID=${1}&imageURI=${1}`)).json();\n    data.push(notes);\n    // });\n\n    setState({ ...state, data: flattenDeep(data), ongoing: false });\n  };\n\n  if (state.ongoing) {\n    fetchNotes();\n  }\n\n  if (state.data.length) {\n    console.log(state.data);\n    playSequence(state, setState);\n  }\n\n  // playSequence(state, setState);\n\n  // const charts = {\n  //   1: 'F3',\n  //   2: 'G3',\n  //   3: 'A3',\n  //   4: 'B3',\n  //   5: 'C4',\n  //   6: 'D4',\n  //   7: 'E4',\n  //   8: 'F4',\n  //   9: 'G4',\n  //   0: 'A4',\n  // };\n\n  // console.log('render');\n\n  // let key = 'C4';\n\n  // Tone.Transport.schedule((time) => {\n  //   synth.triggerAttack(key, time);\n  //   // Tone.Draw.schedule(() => {\n  //   //   document.getElementById(key).style.backgroundColor = '#3c3c3c';\n  //   // }, time);\n  // });\n\n  // window.addEventListener('keydown', (e) => {\n  //   key = charts[e.key];\n  //   Tone.Transport.start('+0.05');\n  // });\n\n  // window.addEventListener('keyup', (e) => {\n  //   key = charts[e.key];\n  //   synth.triggerRelease();\n  //   Tone.Draw.schedule(() => {\n  //     document.getElementById(key).style.backgroundColor = 'transparent';\n  //     Tone.Transport.stop();\n  //   }, '+0.05');\n  // });\n\n  return (\n    <React.Fragment>\n      <div>\n        { /* <input type=\"text\" onChange={updateInput} /> */}\n        <Btn\n          type=\"button\"\n          onClick={getNotes}\n        >\n          {state.ongoing ? 'Fetching...' : 'Release'}\n        </Btn>\n      </div>\n      <Title id=\"text\" />\n\n      <Octaves>\n        {map(octaves, (octave, i) => (\n          <OctaveKey\n            type=\"tone\"\n            id={octave}\n            key={octave}\n            octave={octave}\n            color={colorArray[i]}\n            play={octave === state.play}\n          >\n            {octave}\n          </OctaveKey>\n        ))}\n      </Octaves>\n\n    </React.Fragment>\n  );\n\n  // return (\n  // <div style={{\n  //   display: 'flex',\n  //   flexDirection: 'column',\n  //   justifyContent: 'center',\n  //   alignItems: 'center',\n  //   width: '100%',\n  //   height: '100%',\n  //   position: 'absolute',\n  // }}\n  // >\n  //   <input type=\"text\" onChange={updateInput} />\n  //   <button\n  //     type=\"button\"\n  //     style={{\n  //       background: '#2127f3',\n  //       display: 'inline-block',\n  //       padding: '12px 18px',\n  //       borderRadius: '5px',\n  //       color: '#fff',\n  //       fontWeight: 'bold',\n  //     }}\n  //     onClick={getNotes}\n  //   >\n  //     {state.ongoing ? 'Fetching...' : 'Get Notes'}\n  //   </button>\n  // </div>\n  // );\n};\n\nexport default Notes;\n","export default {\n  debug: false,\n};\n","import { BrowserQRCodeReader } from '@zxing/library';\n\nconst codeReader = new BrowserQRCodeReader();\n\nwindow.code = null;\n\nconst scan = async () => {\n  // const result = await codeReader.decodeFromInputVideoDevice(undefined, 'qr');\n  // window.code = parseInt(result.text, 10);\n  // document.querySelector('[type=\"button\"]').click();\n  // codeReader.reset();\n};\n\nwindow.scan = scan;\n\nexport default scan;\n","import React from 'react';\n\nconst UserEnd = () => <h1>Hello</h1>;\n\nexport default UserEnd;\n","import 'lodash';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { createGlobalStyle } from 'styled-components';\nimport Notes from './components/notes/notes';\nimport config from './config/config';\nimport scan from './components/qr/qr';\nimport UserEnd from './components/userend/userend';\n\nconst GlobalStyle = createGlobalStyle`\n  body {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    background-color: #000;\n    margin: 0;\n    padding: 0;\n    font-family: 'Quicksand', -apple-system, BlinkMacSystemFont, \"Segoe UI\", \"Roboto\", \"Oxygen\",\n      \"Ubuntu\", \"Cantarell\", \"Fira Sans\", \"Droid Sans\", \"Helvetica Neue\",\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, \"Courier New\",\n      monospace;\n  }\n\n  #qr {\n    position: absolute;\n    top: ${config.debug ? '0' : '-100%'};\n    left: ${config.debug ? '0' : '-100%'};\n    width: ${config.debug ? 'auto' : 0};\n    height: ${config.debug ? 'auto' : 0};\n  }\n`;\n\nconst App = props => (\n  <React.Fragment>\n    <GlobalStyle />\n    {props.children}\n  </React.Fragment>\n);\n\nif (window.location.hash.slice(0, 3) === '#t=') {\n  scan();\n\n  ReactDOM.render((\n    <App>\n      <Notes />\n    </App>\n  ), document.getElementById('root'));\n} else {\n  ReactDOM.render((\n    <App>\n      <UserEnd />\n    </App>\n  ), document.getElementById('root'));\n}\n"],"sourceRoot":""}